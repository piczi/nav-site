# 批量导入指南

本指南说明如何使用 Excel 表格批量导入网站和分类数据。

## 文件格式要求

支持以下格式：
- **.xlsx** - Excel 2007+ 格式（推荐）
- **.xls** - Excel 97-2003 格式
- **.csv** - CSV 格式

## 快速开始

1. 在管理后台点击「批量导入」按钮
2. 下载对应类型的模板文件
3. 按照模板格式填写数据
4. 上传文件完成导入

---

## 一、分类导入

### 导入字段说明

| 字段名 | 是否必填 | 类型 | 说明 | 示例 |
|--------|----------|------|------|------|
| **name** | ✅ 必填 | 字符串 | 分类名称 | `开发工具` |
| **slug** | ✅ 必填 | 字符串 | URL标识，唯一值，只能包含字母、数字、中划线和下划线 | `dev-tools` |
| **description** | ❌ 可选 | 字符串 | 分类描述 | `开发者常用的工具和网站` |
| **icon** | ❌ 可选 | 字符串 | 分类图标，支持 emoji 或图片URL | `🛠️` 或 `https://example.com/icon.png` |
| **color** | ❌ 可选 | 字符串 | 主题色，十六进制格式 | `#3b82f6` |
| **sort** | ❌ 可选 | 数字 | 排序权重，数字越小越靠前 | `0` |

### 导入示例

```
name,slug,description,icon,color,sort
开发工具,dev-tools,开发者常用工具,🛠️,#3b82f6,0
设计资源,design,设计相关资源,🎨,#ec4899,1
在线工具,tools,实用的在线工具集合,🔧,#10b981,2
```

### 注意事项

1. **slug 唯一性**：slug 是分类的唯一标识，不能重复。建议使用英文小写、数字和中划线组合
2. **图标格式**：推荐使用 emoji，也可以使用图片 URL（推荐 64x64px 的 PNG 格式）
3. **颜色格式**：必须使用十六进制格式（如 `#3b82f6`），会用于分类卡片的主题色
4. **排序规则**：sort 值越小排序越靠前，建议使用 0、10、20 这样间隔，方便后续插入

---

## 二、网站导入

### 导入字段说明

| 字段名 | 是否必填 | 类型 | 说明 | 示例 |
|--------|----------|------|------|------|
| **title** | ✅ 必填 | 字符串 | 网站名称 | `Google` |
| **url** | ✅ 必填 | 字符串 | 网站链接，必须包含协议（http:// 或 https://） | `https://www.google.com` |
| **description** | ❌ 可选 | 字符串 | 网站描述，用于搜索和展示 | `全球最大的搜索引擎` |
| **icon** | ❌ 可选 | 字符串 | 网站图标，支持 emoji 或图片URL | `🔍` |
| **categoryId** | ⚠️ 二选一 | 字符串 | 分类 ID（优先使用） | `abc123-def456` |
| **categorySlug** | ⚠️ 二选一 | 字符串 | 分类标识（slug） | `dev-tools` |
| **tags** | ❌ 可选 | 字符串 | 标签，用逗号分隔多个标签 | `搜索,工具,谷歌` |
| **isFeatured** | ❌ 可选 | 布尔值 | 是否推荐（首页展示） | `true` 或 `false` |
| **isShow** | ❌ 可选 | 布尔值 | 是否显示 | `true` 或 `false` |
| **sort** | ❌ 可选 | 数字 | 排序权重，数字越小越靠前 | `0` |

### 分类关联说明

**必须指定分类**，有两种方式：

**方式一：使用 categoryId（推荐）**
- 在模板文件的「可用分类」工作表中查看所有分类的 ID
- 将分类 ID 填入 categoryId 列

**方式二：使用 categorySlug**
- 直接使用分类的 slug 标识
- 填入 categorySlug 列

### 导入示例

```
title,url,description,icon,categorySlug,tags,isFeatured,isShow,sort
Google,https://www.google.com,全球最大的搜索引擎,🔍,dev-tools,搜索,工具,true,true,0
GitHub,https://github.com,代码托管平台,💻,dev-tools,代码,开源,true,true,1
Figma,https://www.figma.com,在线设计协作工具,✏️,design,设计,UI,false,true,2
```

### 注意事项

1. **URL 格式**：必须以 `http://` 或 `https://` 开头，否则无法通过验证
2. **分类必须存在**：导入前请先确保分类已创建，或先导入分类
3. **标签格式**：多个标签用逗号分隔，导入后会自动去重和清理空格
4. **布尔值格式**：支持 `true`/`false`、`1`/`0`、`yes`/`no` 等格式
5. **图标自动获取**：如果不填写图标，系统会尝试自动获取网站的 favicon
6. **重复导入**：同一网址可以重复导入（不同分类下），系统不限制

---

## 三、模板文件结构

下载的模板文件包含三个工作表：

### 1. 模板（第一个工作表）
包含示例数据，直接在此基础上修改即可。

### 2. 字段说明
列出所有字段的详细说明和示例。

### 3. 可用分类（仅网站导入模板）
列出系统中所有可用的分类，包含：
- ID：分类的唯一标识
- 名称：分类名称
- 标识：分类的 slug

**提示**：建议先创建好分类，再导入网站，这样可以确保分类关联正确。

---

## 四、导入流程

### 最佳实践

1. **先导入分类**
   - 分类是网站的基础，建议先创建好所有分类
   - 导入分类后，可以在模板中看到可用分类列表

2. **分批导入**
   - 建议每次导入不超过 100 条数据
   - 大批量导入可以分多次完成

3. **先测试后正式**
   - 首次导入建议先导入几条测试数据
   - 确认数据格式正确后再导入全部

### 导入结果说明

导入完成后会显示：
- ✅ **成功数**：成功导入的数据条数
- ❌ **失败数**：导入失败的数据条数
- **错误详情**：失败的行号和具体原因

### 常见错误

| 错误信息 | 原因 | 解决方法 |
|---------|------|---------|
| 名称和标识不能为空 | 必填字段未填写 | 检查必填字段是否填写完整 |
| 该标识已被使用 | slug 已存在 | 修改 slug 或先删除已有分类 |
| 网址格式不正确 | URL 格式错误 | 确保 URL 包含 http:// 或 https:// |
| 分类不存在 | 分类 ID 或 slug 错误 | 检查分类信息，确保分类已创建 |

---

## 五、Excel 填写技巧

### 数据格式

1. **文本格式**：所有字段都应以文本格式存储，避免 Excel 自动转换
2. **URL 格式**：URL 列建议设置为「文本」格式，防止 Excel 自动添加超链接
3. **数字格式**：sort 列应为数字格式

### 批量填充

1. **快速填充**：选中单元格右下角拖动，Excel 会自动填充序号
2. **复制粘贴**：可以从其他表格直接复制粘贴，确保列名对应
3. **查找替换**：使用 Ctrl+H 批量替换文本

### 数据验证

建议开启 Excel 的数据验证功能，限制输入格式：
- URL 列：正则验证 `^https?://.*`
- 布尔值列：下拉列表选择 `true`/`false`
- 分类 slug：下拉列表选择（根据「可用分类」工作表）

---

## 六、CSV 格式说明

如果使用 CSV 格式：

1. **编码**：必须使用 UTF-8 编码，否则中文会乱码
2. **分隔符**：使用逗号 `,` 分隔字段
3. **引号**：如果字段包含逗号或换行符，必须用双引号包裹
4. **换行**：每行数据以换行符分隔

### CSV 示例

```csv
title,url,description,categorySlug,tags
Google,https://www.google.com,搜索引擎,dev-tools,"搜索,工具"
GitHub,https://github.com,代码托管,dev-tools,"代码,开源,Git"
```

**注意**：包含逗号的 tags 字段必须用双引号包裹。

---

## 七、支持帮助

遇到问题？

1. **查看错误详情**：导入失败时会显示具体的行号和错误原因
2. **检查模板**：确保使用了最新的模板文件
3. **分批导入**：将数据分成小批次导入，便于定位问题
4. **联系管理员**：如遇到系统错误，请联系网站管理员

---

**最后更新**：2026年2月
